{"ast":null,"code":"import axios from \"axios\";\nimport MockAdapter from \"axios-mock-adapter\";\nconst mock = new MockAdapter(axios, {\n  delayResponse: 3000\n});\nconst user = {\n  fullName: 'Mr. FabiozZz Loucoster',\n  birthDay: '20/10/1989',\n  phone: '+79996569772',\n  email: 'fabiozzz.dev@gmail.com'\n};\nmock.onPost('/auth/login').reply(200, {\n  user,\n  accessToken: 'TOKEN_ACC',\n  refreshToken: 'TOKEN_REF'\n});\n/**\n * response на логин token & refreshToken\n */\n\nexport default class APIJWT {\n  constructor(options = {}) {\n    this.client = axios.create();\n    this.client.interceptors.request.use(config => {\n      if (!localStorage.getItem('token')) {\n        return config;\n      }\n\n      const newConfig = {\n        headers: {},\n        ...config\n      };\n      newConfig.headers.Authorization = `Bearer ${localStorage.getItem('token')}`;\n      return newConfig;\n    }, error => Promise.reject(error));\n  }\n\n  async login({\n    login,\n    password\n  }) {\n    const {\n      data\n    } = await this.client.post('/auth/login', {\n      login,\n      password\n    });\n    localStorage.setItem('token', await data.accessToken);\n    return data;\n  }\n\n  logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('refreshToken');\n  }\n\n  getUsers() {\n    return this.client.get('/users').then(({\n      data\n    }) => data);\n  }\n\n}","map":{"version":3,"sources":["/home/fabiozzz/www/react/y-champion/for-user/src/exampleApi/APIJWT.js"],"names":["axios","MockAdapter","mock","delayResponse","user","fullName","birthDay","phone","email","onPost","reply","accessToken","refreshToken","APIJWT","constructor","options","client","create","interceptors","request","use","config","localStorage","getItem","newConfig","headers","Authorization","error","Promise","reject","login","password","data","post","setItem","logout","removeItem","getUsers","get","then"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,oBAAxB;AAEA,MAAMC,IAAI,GAAG,IAAID,WAAJ,CAAgBD,KAAhB,EAAsB;AAACG,EAAAA,aAAa,EAAC;AAAf,CAAtB,CAAb;AACA,MAAMC,IAAI,GAAG;AACTC,EAAAA,QAAQ,EAAC,wBADA;AAETC,EAAAA,QAAQ,EAAE,YAFD;AAGTC,EAAAA,KAAK,EAAE,cAHE;AAITC,EAAAA,KAAK,EAAE;AAJE,CAAb;AAMAN,IAAI,CAACO,MAAL,CAAY,aAAZ,EAA2BC,KAA3B,CAAiC,GAAjC,EAAsC;AAACN,EAAAA,IAAD;AAAMO,EAAAA,WAAW,EAAE,WAAnB;AAAgCC,EAAAA,YAAY,EAAE;AAA9C,CAAtC;AACA;AACA;AACA;;AAGA,eAAgB,MAAMC,MAAN,CAAa;AACzBC,EAAAA,WAAW,CAACC,OAAO,GAAC,EAAT,EAAa;AACpB,SAAKC,MAAL,GAAchB,KAAK,CAACiB,MAAN,EAAd;AAEA,SAAKD,MAAL,CAAYE,YAAZ,CAAyBC,OAAzB,CAAiCC,GAAjC,CAAqCC,MAAM,IAAE;AACzC,UAAI,CAACC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAL,EAAoC;AAChC,eAAOF,MAAP;AACH;;AAED,YAAMG,SAAS,GAAE;AACbC,QAAAA,OAAO,EAAC,EADK;AAEb,WAAGJ;AAFU,OAAjB;AAIAG,MAAAA,SAAS,CAACC,OAAV,CAAkBC,aAAlB,GAAmC,UAASJ,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B,EAA1E;AACA,aAAOC,SAAP;AAEH,KAZD,EAYEG,KAAK,IAAIC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAZX;AAcH;;AAEU,QAALG,KAAK,CAAC;AAACA,IAAAA,KAAD;AAAOC,IAAAA;AAAP,GAAD,EAAmB;AAC1B,UAAM;AAACC,MAAAA;AAAD,QAAS,MAAM,KAAKhB,MAAL,CAAYiB,IAAZ,CAAiB,aAAjB,EAA+B;AAACH,MAAAA,KAAD;AAAOC,MAAAA;AAAP,KAA/B,CAArB;AACAT,IAAAA,YAAY,CAACY,OAAb,CAAqB,OAArB,EAA6B,MAAMF,IAAI,CAACrB,WAAxC;AACA,WAAOqB,IAAP;AACH;;AAEDG,EAAAA,MAAM,GAAG;AACLb,IAAAA,YAAY,CAACc,UAAb,CAAwB,OAAxB;AACAd,IAAAA,YAAY,CAACc,UAAb,CAAwB,cAAxB;AAEH;;AAEDC,EAAAA,QAAQ,GAAG;AACP,WAAO,KAAKrB,MAAL,CAAYsB,GAAZ,CAAgB,QAAhB,EAA0BC,IAA1B,CAA+B,CAAC;AAACP,MAAAA;AAAD,KAAD,KAAYA,IAA3C,CAAP;AACH;;AAlCwB","sourcesContent":["import axios from \"axios\";\nimport MockAdapter from \"axios-mock-adapter\";\n\nconst mock = new MockAdapter(axios,{delayResponse:3000});\nconst user = {\n    fullName:'Mr. FabiozZz Loucoster',\n    birthDay: '20/10/1989',\n    phone: '+79996569772',\n    email: 'fabiozzz.dev@gmail.com',\n}\nmock.onPost('/auth/login').reply(200, {user,accessToken: 'TOKEN_ACC', refreshToken: 'TOKEN_REF'});\n/**\n * response на логин token & refreshToken\n */\n\n\nexport default  class APIJWT {\n    constructor(options={}) {\n        this.client = axios.create();\n\n        this.client.interceptors.request.use(config=>{\n            if (!localStorage.getItem('token')) {\n                return config\n            }\n\n            const newConfig ={\n                headers:{},\n                ...config,\n            }\n            newConfig.headers.Authorization = `Bearer ${localStorage.getItem('token')}`\n            return newConfig\n\n        },error => Promise.reject(error))\n\n    }\n\n    async login({login,password}) {\n        const {data} = await this.client.post('/auth/login',{login,password})\n        localStorage.setItem('token',await data.accessToken);\n        return data;\n    }\n\n    logout() {\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n\n    }\n\n    getUsers() {\n        return this.client.get('/users').then(({data}) => data);\n    }\n}"]},"metadata":{},"sourceType":"module"}